# 07. 面积占比计算与几何分析 (Area Ratio & Geometric Analysis)

## 1. 核心计算逻辑
计算二维码在整张图像中的视觉占比。

### 1.1 简单包围盒法 (Bounding Rect)
适用于正对拍摄、无明显倾斜的图片。
$$ Area_{QR} = Width_{rect} \times Height_{rect} $$

### 1.2 多边形面积法 (Polygon Area)
适用于有透视变形、倾斜拍摄的图片。检测到的二维码通常是一个不规则四边形。
使用 Shoelace Formula（鞋带公式）计算四边形面积：
$$ Area = \frac{1}{2} |(x_1y_2 + x_2y_3 + x_3y_4 + x_4y_1) - (y_1x_2 + y_2x_3 + y_3x_4 + y_4x_1)| $$

### 1.3 占比计算
$$ Ratio = \frac{Area_{QR}}{Image_{Width} \times Image_{Height}} $$

## 2. 判定逻辑
- **阈值**：5%
- **判定**：
  - 若 $Ratio > 0.05$：**合格 (Pass)**
  - 若 $Ratio \le 0.05$：**过小 (Too Small)** - 二维码过小可能导致远距离扫描困难。

## 3. 边缘情况处理
- **多二维码**：如果图中检测到多个二维码，通常取**最大**的那个进行主分析，或返回列表。本方案默认取最大面积者。
- **不完整二维码**：如果二维码在图像边缘被截断，面积计算仍基于可见部分，但应在返回结果中标记“可能不完整”。
